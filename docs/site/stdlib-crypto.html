<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>crypto - Nex Docs</title>
  <link rel="stylesheet" href="styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
<header class="site-header">
  <button class="menu-toggle">&#9776;</button>
  <div class="logo">Nex <span>Documentation</span></div>
  <div class="header-right"><span class="version-badge">v0.1.135</span></div>
</header>
<nav class="sidebar"></nav>
<main class="main-content">

  <div class="breadcrumbs"><a href="index.html">Docs</a><span class="sep">/</span><a href="lib-overview.html">Standard Libraries</a><span class="sep">/</span>crypto</div>

  <h1>crypto</h1>
  <p class="page-subtitle">Cryptographic hashing, encryption, digital signatures, key derivation, encoding, and random byte generation.</p>

  <h2>Setup</h2>
  <p>Add to your <code>project.toml</code>:</p>
  <pre><code>[libs]
crypto = { path = "../libs/crypto" }</code></pre>

  <pre><code><span class="kw">import</span> crypto.hash
<span class="kw">import</span> crypto.encode
<span class="kw">import</span> crypto.hmac
<span class="kw">import</span> crypto.random
<span class="kw">import</span> crypto.aes
<span class="kw">import</span> crypto.ed25519
<span class="kw">import</span> crypto.kdf</code></pre>

  <h2>Hashing</h2>

  <h4>sha256</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">sha256</span>(s: <span class="typ">String</span>) <span class="op">-&gt;</span> <span class="typ">String</span>
  </div>
  <p>Returns the hex-encoded SHA-256 hash of the input string. Produces a 64-character lowercase hex string.</p>

  <pre><code><span class="kw">import</span> crypto.hash

hash <span class="op">=</span> <span class="fn">sha256</span>(<span class="str">"hello"</span>)
<span class="fn">println</span>(hash)   <span class="cmt">// 2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824</span></code></pre>

  <h4>sha512</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">sha512</span>(s: <span class="typ">String</span>) <span class="op">-&gt;</span> <span class="typ">String</span>
  </div>
  <p>Returns the hex-encoded SHA-512 hash of the input string. Produces a 128-character lowercase hex string.</p>

  <h4>sha1</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">sha1</span>(s: <span class="typ">String</span>) <span class="op">-&gt;</span> <span class="typ">String</span>
  </div>
  <p>Returns the hex-encoded SHA-1 hash of the input string. Produces a 40-character lowercase hex string. Required for protocols like WebSocket (RFC 6455).</p>

  <h4>md5</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">md5</span>(s: <span class="typ">String</span>) <span class="op">-&gt;</span> <span class="typ">String</span>
  </div>
  <p>Returns the hex-encoded MD5 hash of the input string. Produces a 32-character lowercase hex string. Not recommended for security-sensitive purposes; prefer SHA-256 or SHA-512.</p>

  <h4>hmac_sha256</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">hmac_sha256</span>(key: <span class="typ">String</span>, msg: <span class="typ">String</span>) <span class="op">-&gt;</span> <span class="typ">String</span>
  </div>
  <p>Computes the HMAC-SHA256 message authentication code using <code>key</code> and <code>msg</code>. Returns a hex-encoded digest string. Useful for verifying message integrity and authenticity.</p>

  <h2>Encoding</h2>

  <h4>base64_encode</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">base64_encode</span>(s: <span class="typ">String</span>) <span class="op">-&gt;</span> <span class="typ">String</span>
  </div>
  <p>Encodes the input string to Base64 format. Useful for embedding binary data in text-based protocols like JSON or HTTP headers.</p>

  <h4>base64_decode</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">base64_decode</span>(s: <span class="typ">String</span>) <span class="op">-&gt;</span> <span class="typ">String</span>
  </div>
  <p>Decodes a Base64-encoded string back to its original form.</p>

  <h2>Random Bytes</h2>

  <h4>random_bytes</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">random_bytes</span>(count: <span class="typ">Int</span>) <span class="op">-&gt;</span> <span class="typ">Var</span>
  </div>
  <p>Fills a buffer with <code>count</code> cryptographically secure random bytes and returns it. Suitable for generating keys, nonces, and salts.</p>

  <h2>Encryption (AES-256-GCM)</h2>

  <h4>aes_encrypt</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">aes_encrypt</span>(key: <span class="typ">String</span>, nonce: <span class="typ">String</span>, plaintext: <span class="typ">String</span>) <span class="op">-&gt;</span> <span class="typ">String</span>
  </div>
  <p>Encrypts <code>plaintext</code> using AES-256-GCM. The <code>key</code> must be 64 hex characters (32 bytes) and <code>nonce</code> must be 24 hex characters (12 bytes). Returns the ciphertext as a hex string.</p>

  <h4>aes_decrypt</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">aes_decrypt</span>(key: <span class="typ">String</span>, nonce: <span class="typ">String</span>, ciphertext: <span class="typ">String</span>) <span class="op">-&gt;</span> <span class="typ">String</span>
  </div>
  <p>Decrypts <code>ciphertext</code> using AES-256-GCM. Returns the original plaintext, or an empty string on failure.</p>

  <pre><code><span class="kw">import</span> crypto.aes

key <span class="op">=</span> <span class="str">"0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef"</span>
nonce <span class="op">=</span> <span class="str">"000000000000000000000000"</span>

encrypted <span class="op">=</span> <span class="fn">aes_encrypt</span>(key, nonce, <span class="str">"secret message"</span>)
decrypted <span class="op">=</span> <span class="fn">aes_decrypt</span>(key, nonce, encrypted)
<span class="fn">println</span>(decrypted)  <span class="cmt">// "secret message"</span></code></pre>

  <h2>Digital Signatures (Ed25519)</h2>

  <h4>ed25519_keygen</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">ed25519_keygen</span>() <span class="op">-&gt;</span> <span class="typ">String</span>
  </div>
  <p>Generates an Ed25519 keypair. Returns a hex string containing the 32-byte public key followed by the 32-byte private key (128 hex characters total).</p>

  <h4>ed25519_sign</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">ed25519_sign</span>(private_key: <span class="typ">String</span>, message: <span class="typ">String</span>) <span class="op">-&gt;</span> <span class="typ">String</span>
  </div>
  <p>Signs <code>message</code> with the Ed25519 private key. Returns the 64-byte signature as a hex string.</p>

  <h4>ed25519_verify</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">ed25519_verify</span>(public_key: <span class="typ">String</span>, message: <span class="typ">String</span>, signature: <span class="typ">String</span>) <span class="op">-&gt;</span> <span class="typ">Int</span>
  </div>
  <p>Verifies an Ed25519 signature. Returns <code>1</code> if valid, <code>0</code> if invalid.</p>

  <h2>Key Derivation</h2>

  <h4>pbkdf2</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">pbkdf2</span>(password: <span class="typ">String</span>, salt: <span class="typ">String</span>, iterations: <span class="typ">Int</span>, key_len: <span class="typ">Int</span>) <span class="op">-&gt;</span> <span class="typ">String</span>
  </div>
  <p>Derives a key from a password using PBKDF2-HMAC-SHA256. Returns the derived key as a hex string.</p>

  <h4>argon2</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">argon2</span>(password: <span class="typ">String</span>, salt: <span class="typ">String</span>, key_len: <span class="typ">Int</span>) <span class="op">-&gt;</span> <span class="typ">String</span>
  </div>
  <p>Derives a key from a password using Argon2id (memory-hard). Returns the derived key as a hex string. Recommended for password hashing.</p>

  <pre><code><span class="kw">import</span> crypto.kdf

<span class="cmt">// PBKDF2 key derivation</span>
key <span class="op">=</span> <span class="fn">pbkdf2</span>(<span class="str">"password"</span>, <span class="str">"salt123"</span>, <span class="num">100000</span>, <span class="num">32</span>)
<span class="fn">println</span>(key)

<span class="cmt">// Argon2id (recommended for password hashing)</span>
hash <span class="op">=</span> <span class="fn">argon2</span>(<span class="str">"password"</span>, <span class="str">"random_salt"</span>, <span class="num">32</span>)
<span class="fn">println</span>(hash)</code></pre>

  <h2>Complete Example</h2>

  <pre><code><span class="kw">import</span> crypto.hash
<span class="kw">import</span> crypto.encode
<span class="kw">import</span> crypto.hmac
<span class="kw">import</span> crypto.random

<span class="cmt">// Hash a password with SHA-256</span>
password <span class="op">=</span> <span class="str">"my_secret_password"</span>
hashed <span class="op">=</span> <span class="fn">sha256</span>(password)
<span class="fn">print</span>(<span class="str">"SHA-256: "</span>)
<span class="fn">println</span>(hashed)

<span class="cmt">// Compare with SHA-512</span>
hashed512 <span class="op">=</span> <span class="fn">sha512</span>(password)
<span class="fn">print</span>(<span class="str">"SHA-512: "</span>)
<span class="fn">println</span>(hashed512)

<span class="cmt">// HMAC for API authentication</span>
secret <span class="op">=</span> <span class="str">"api_key_2024"</span>
message <span class="op">=</span> <span class="str">"GET /api/users?ts=1708617600"</span>
signature <span class="op">=</span> <span class="fn">hmac_sha256</span>(secret, message)
<span class="fn">print</span>(<span class="str">"HMAC signature: "</span>)
<span class="fn">println</span>(signature)

<span class="cmt">// Base64 encode/decode a payload</span>
payload <span class="op">=</span> <span class="str">"username:password"</span>
encoded <span class="op">=</span> <span class="fn">base64_encode</span>(payload)
<span class="fn">print</span>(<span class="str">"Encoded: "</span>)
<span class="fn">println</span>(encoded)   <span class="cmt">// dXNlcm5hbWU6cGFzc3dvcmQ=</span>

decoded <span class="op">=</span> <span class="fn">base64_decode</span>(encoded)
<span class="fn">print</span>(<span class="str">"Decoded: "</span>)
<span class="fn">println</span>(decoded)   <span class="cmt">// username:password</span>

<span class="cmt">// Generate random bytes for a salt</span>
salt <span class="op">=</span> <span class="fn">random_bytes</span>(<span class="num">16</span>)
<span class="fn">print</span>(<span class="str">"Random salt generated: "</span>)
<span class="fn">println</span>(salt)</code></pre>

  <div class="page-nav">
    <a href="lib-overview.html">
      <span class="nav-label">Previous</span>
      <span class="nav-title">&larr; Standard Libraries Overview</span>
    </a>
    <a href="stdlib-http.html">
      <span class="nav-label">Next</span>
      <span class="nav-title">http &rarr;</span>
    </a>
  </div>

</main>
<script src="nav.js"></script>
<script src="script.js"></script>
</body>
</html>
