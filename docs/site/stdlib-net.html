<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>std.net - Nex Docs</title>
  <link rel="stylesheet" href="styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
<header class="site-header">
  <button class="menu-toggle">&#9776;</button>
  <div class="logo">Nex <span>Documentation</span></div>
  <div class="header-right"><span class="version-badge">v0.1.154</span></div>
</header>
<nav class="sidebar"></nav>
<main class="main-content">

  <div class="breadcrumbs"><a href="index.html">Docs</a><span class="sep">/</span><a href="stdlib-overview.html">Standard Library</a><span class="sep">/</span>std.net</div>

  <h1>std.net</h1>
  <p class="page-subtitle">TCP/UDP networking, TLS/SSL, and WebSocket support.</p>

  <pre><code><span class="kw">import</span> std.net</code></pre>

  <h2>TCP Client</h2>

  <h4>tcp_connect</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">tcp_connect</span>(host: <span class="typ">String</span>, port: <span class="typ">Int</span>) <span class="op">-&gt;</span> <span class="typ">Var</span>
  </div>
  <p>Establishes a TCP connection to the given <code>host</code> and <code>port</code>. Returns a socket handle on success, or a null handle on failure.</p>

  <h4>tcp_close</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">tcp_close</span>(handle: <span class="typ">Var</span>) <span class="op">-&gt;</span> <span class="typ">Unit</span>
  </div>
  <p>Closes a TCP connection and releases the socket handle.</p>

  <h4>tcp_send</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">tcp_send</span>(handle: <span class="typ">Var</span>, data: <span class="typ">String</span>) <span class="op">-&gt;</span> <span class="typ">Int</span>
  </div>
  <p>Sends data over the TCP connection. Returns the number of bytes sent, or <code>-1</code> on error.</p>

  <h4>tcp_recv</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">tcp_recv</span>(handle: <span class="typ">Var</span>, max_len: <span class="typ">Int</span>) <span class="op">-&gt;</span> <span class="typ">String</span>
  </div>
  <p>Receives up to <code>max_len</code> bytes from the TCP connection. Blocks until data is available. Returns an empty string on connection close or error.</p>

  <pre><code><span class="kw">import</span> std.net

<span class="cmt">// Connect to a server</span>
<span class="kw">var</span> conn <span class="op">=</span> <span class="fn">tcp_connect</span>(<span class="str">"example.com"</span>, <span class="num">80</span>)

<span class="cmt">// Send an HTTP request</span>
request <span class="op">=</span> <span class="str">"GET / HTTP/1.0\r\nHost: example.com\r\n\r\n"</span>
<span class="fn">tcp_send</span>(conn, request)

<span class="cmt">// Read the response</span>
response <span class="op">=</span> <span class="fn">tcp_recv</span>(conn, <span class="num">4096</span>)
<span class="fn">println</span>(response)

<span class="fn">tcp_close</span>(conn)</code></pre>

  <h2>TCP Server</h2>

  <h4>tcp_listen</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">tcp_listen</span>(host: <span class="typ">String</span>, port: <span class="typ">Int</span>) <span class="op">-&gt;</span> <span class="typ">Var</span>
  </div>
  <p>Creates a TCP listener that binds to <code>host</code> and <code>port</code>. The listener is ready to accept incoming connections. Returns a listener handle.</p>

  <h4>tcp_accept</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">tcp_accept</span>(listener: <span class="typ">Var</span>) <span class="op">-&gt;</span> <span class="typ">Var</span>
  </div>
  <p>Accepts an incoming TCP connection from the listener. Blocks until a client connects. Returns a socket handle for the new connection.</p>

  <pre><code><span class="kw">import</span> std.net

<span class="cmt">// Start a server</span>
<span class="kw">var</span> listener <span class="op">=</span> <span class="fn">tcp_listen</span>(<span class="str">"127.0.0.1"</span>, <span class="num">9000</span>)
<span class="fn">println</span>(<span class="str">"Listening on port 9000..."</span>)

<span class="cmt">// Accept one connection</span>
<span class="kw">var</span> client <span class="op">=</span> <span class="fn">tcp_accept</span>(listener)
<span class="fn">println</span>(<span class="str">"Client connected"</span>)

data <span class="op">=</span> <span class="fn">tcp_recv</span>(client, <span class="num">1024</span>)
<span class="fn">println</span>(<span class="str">"Received: "</span>)
<span class="fn">println</span>(data)

<span class="fn">tcp_send</span>(client, <span class="str">"ACK"</span>)
<span class="fn">tcp_close</span>(client)
<span class="fn">tcp_close</span>(listener)</code></pre>

  <h2>UDP</h2>

  <h4>udp_bind</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">udp_bind</span>(host: <span class="typ">String</span>, port: <span class="typ">Int</span>) <span class="op">-&gt;</span> <span class="typ">Var</span>
  </div>
  <p>Creates a UDP socket bound to the given <code>host</code> and <code>port</code>. The socket can both send and receive datagrams.</p>

  <h4>udp_close</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">udp_close</span>(handle: <span class="typ">Var</span>) <span class="op">-&gt;</span> <span class="typ">Unit</span>
  </div>
  <p>Closes a UDP socket and releases its resources.</p>

  <h4>udp_send</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">udp_send</span>(handle: <span class="typ">Var</span>, data: <span class="typ">String</span>, host: <span class="typ">String</span>, port: <span class="typ">Int</span>) <span class="op">-&gt;</span> <span class="typ">Int</span>
  </div>
  <p>Sends a datagram to the specified <code>host</code> and <code>port</code>. Returns the number of bytes sent, or <code>-1</code> on error.</p>

  <h4>udp_recv</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">udp_recv</span>(handle: <span class="typ">Var</span>, max_len: <span class="typ">Int</span>) <span class="op">-&gt;</span> <span class="typ">String</span>
  </div>
  <p>Receives a datagram of up to <code>max_len</code> bytes. Blocks until a datagram arrives. Returns the data as a string.</p>

  <pre><code><span class="kw">import</span> std.net

<span class="cmt">// Send a UDP message</span>
<span class="kw">var</span> sock <span class="op">=</span> <span class="fn">udp_bind</span>(<span class="str">"0.0.0.0"</span>, <span class="num">0</span>)
<span class="fn">udp_send</span>(sock, <span class="str">"ping"</span>, <span class="str">"127.0.0.1"</span>, <span class="num">9001</span>)
<span class="fn">udp_close</span>(sock)</code></pre>

  <h2>Complete Example</h2>

  <pre><code><span class="kw">import</span> std.net

<span class="cmt">// TCP echo server</span>
<span class="kw">def</span> <span class="fn">echo_server</span>(host: <span class="typ">String</span>, port: <span class="typ">Int</span>) <span class="op">-&gt;</span> <span class="typ">Unit</span> {
    <span class="kw">var</span> listener <span class="op">=</span> <span class="fn">tcp_listen</span>(host, port)
    <span class="fn">print</span>(<span class="str">"Echo server listening on "</span>)
    <span class="fn">print</span>(host)
    <span class="fn">print</span>(<span class="str">":"</span>)
    <span class="fn">println</span>(port)

    running <span class="op">=</span> <span class="kw">true</span>
    <span class="kw">while</span> (running) {
        <span class="fn">println</span>(<span class="str">"Waiting for connection..."</span>)
        <span class="kw">var</span> client <span class="op">=</span> <span class="fn">tcp_accept</span>(listener)
        <span class="fn">println</span>(<span class="str">"Client connected"</span>)

        <span class="cmt">// Echo loop for this client</span>
        connected <span class="op">=</span> <span class="kw">true</span>
        <span class="kw">while</span> (connected) {
            data <span class="op">=</span> <span class="fn">tcp_recv</span>(client, <span class="num">1024</span>)
            <span class="kw">if</span> (data <span class="op">==</span> <span class="str">""</span>) {
                <span class="fn">println</span>(<span class="str">"Client disconnected"</span>)
                connected <span class="op">=</span> <span class="kw">false</span>
            } <span class="kw">else</span> {
                <span class="fn">print</span>(<span class="str">"Echo: "</span>)
                <span class="fn">println</span>(data)
                sent <span class="op">=</span> <span class="fn">tcp_send</span>(client, data)
                <span class="kw">if</span> (sent <span class="op">==</span> <span class="num">-1</span>) {
                    <span class="fn">println</span>(<span class="str">"Send error"</span>)
                    connected <span class="op">=</span> <span class="kw">false</span>
                }
            }
        }
        <span class="fn">tcp_close</span>(client)
    }

    <span class="fn">tcp_close</span>(listener)
}

<span class="fn">echo_server</span>(<span class="str">"127.0.0.1"</span>, <span class="num">7000</span>)</code></pre>

  <h2>TLS/SSL Client</h2>

  <p>Secure TLS connections using the <code>net.tls</code> library module. Requires adding the <code>net</code> library to your <code>project.toml</code>.</p>

  <div class="callout info">
    <div class="callout-title">Library Module</div>
    <p>TLS is provided by the <code>net</code> standard library, not the built-in <code>std.net</code>. Add it to your <code>project.toml</code>:</p>
  </div>

  <pre><code>[libs]
net = { path = "../libs/net" }</code></pre>

  <pre><code><span class="kw">import</span> net.tls</code></pre>

  <h4>tls.connect</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">connect</span>(host: <span class="typ">String</span>, port: <span class="typ">Int</span>) <span class="op">-&gt;</span> <span class="typ">Int</span>
  </div>
  <p>Establishes a TLS connection to the given host and port. Returns a TLS stream handle, or <code>0</code> on failure.</p>

  <h4>tls.send</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">send</span>(conn: <span class="typ">Int</span>, data: <span class="typ">String</span>) <span class="op">-&gt;</span> <span class="typ">Int</span>
  </div>
  <p>Sends data over the TLS connection. Returns the number of bytes sent, or <code>-1</code> on failure.</p>

  <h4>tls.recv</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">recv</span>(conn: <span class="typ">Int</span>, max_len: <span class="typ">Int</span>) <span class="op">-&gt;</span> <span class="typ">String</span>
  </div>
  <p>Receives up to <code>max_len</code> bytes from the TLS connection. Returns the data as a string.</p>

  <h4>tls.close</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">close</span>(conn: <span class="typ">Int</span>) <span class="op">-&gt;</span> <span class="typ">Unit</span>
  </div>
  <p>Closes the TLS connection and frees resources.</p>

  <pre><code><span class="kw">import</span> net.tls

<span class="cmt">// HTTPS request via TLS</span>
conn <span class="op">=</span> <span class="fn">tls.connect</span>(<span class="str">"example.com"</span>, <span class="num">443</span>)
<span class="fn">tls.send</span>(conn, <span class="str">"GET / HTTP/1.1\r\nHost: example.com\r\nConnection: close\r\n\r\n"</span>)
response <span class="op">=</span> <span class="fn">tls.recv</span>(conn, <span class="num">4096</span>)
<span class="fn">println</span>(response)
<span class="fn">tls.close</span>(conn)</code></pre>

  <h2>WebSocket Server</h2>

  <p>RFC 6455 WebSocket server provided by the <code>net.websocket</code> library module.</p>

  <pre><code><span class="kw">import</span> net.websocket</code></pre>

  <h4>websocket.listen</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">listen</span>(port: <span class="typ">Int</span>) <span class="op">-&gt;</span> <span class="typ">Int</span>
  </div>
  <p>Creates a WebSocket server listening on the given port. Returns a server handle, or <code>0</code> on failure.</p>

  <h4>websocket.accept</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">accept</span>(server: <span class="typ">Int</span>) <span class="op">-&gt;</span> <span class="typ">Int</span>
  </div>
  <p>Blocks until a client connects and completes the WebSocket handshake. Returns a connection handle.</p>

  <h4>websocket.send</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">send</span>(conn: <span class="typ">Int</span>, message: <span class="typ">String</span>) <span class="op">-&gt;</span> <span class="typ">Int</span>
  </div>
  <p>Sends a text message over the WebSocket connection. Returns bytes sent, or <code>-1</code> on failure.</p>

  <h4>websocket.recv</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">recv</span>(conn: <span class="typ">Int</span>) <span class="op">-&gt;</span> <span class="typ">String</span>
  </div>
  <p>Receives a text message. Blocks until a message arrives. Returns <code>""</code> on close or error.</p>

  <h4>websocket.close</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">close</span>(conn: <span class="typ">Int</span>) <span class="op">-&gt;</span> <span class="typ">Unit</span>
  </div>
  <p>Closes a WebSocket connection (sends close frame).</p>

  <h4>websocket.close_server</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">close_server</span>(server: <span class="typ">Int</span>) <span class="op">-&gt;</span> <span class="typ">Unit</span>
  </div>
  <p>Shuts down the WebSocket server.</p>

  <pre><code><span class="kw">import</span> net.websocket

<span class="cmt">// Simple WebSocket echo server</span>
srv <span class="op">=</span> <span class="fn">websocket.listen</span>(<span class="num">9001</span>)
<span class="fn">println</span>(<span class="str">"WebSocket server on port 9001"</span>)

conn <span class="op">=</span> <span class="fn">websocket.accept</span>(srv)
<span class="fn">println</span>(<span class="str">"Client connected"</span>)

<span class="fn">websocket.send</span>(conn, <span class="str">"Hello from Nex!"</span>)
msg <span class="op">=</span> <span class="fn">websocket.recv</span>(conn)
<span class="fn">println</span>(<span class="str">"Received: "</span> <span class="op">+</span> msg)

<span class="fn">websocket.close</span>(conn)
<span class="fn">websocket.close_server</span>(srv)</code></pre>

  <div class="page-nav">
    <a href="stdlib-process.html">
      <span class="nav-label">Previous</span>
      <span class="nav-title">&larr; std.process</span>
    </a>
    <a href="stdlib-threading.html">
      <span class="nav-label">Next</span>
      <span class="nav-title">std.threading &rarr;</span>
    </a>
  </div>

</main>
<script src="nav.js"></script>
<script src="script.js"></script>
</body>
</html>
