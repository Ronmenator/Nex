<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Control Flow - Nex Docs</title>
  <link rel="stylesheet" href="styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
<header class="site-header">
  <button class="menu-toggle">&#9776;</button>
  <div class="logo">Nex <span>Documentation</span></div>
  <div class="header-right"><span class="version-badge">v0.1.154</span></div>
</header>
<nav class="sidebar"></nav>
<main class="main-content">

  <div class="breadcrumbs"><a href="index.html">Docs</a><span class="sep">/</span>Language Guide<span class="sep">/</span>Control Flow</div>

  <h1>Control Flow</h1>
  <p class="page-subtitle">Conditionals, loops, and branching in Nex.</p>

  <h2>If / Else</h2>

  <p>The <code>if</code> statement evaluates a condition inside parentheses. The body is always a block with braces:</p>

  <pre><code><span class="kw">if</span> (temperature <span class="op">&gt;</span> <span class="num">30</span>) {
    <span class="fn">println</span>(<span class="str">"It's hot!"</span>)
}</code></pre>

  <h3>If / Else If / Else</h3>

  <pre><code><span class="kw">if</span> (score <span class="op">&gt;=</span> <span class="num">90</span>) {
    <span class="fn">println</span>(<span class="str">"A"</span>)
} <span class="kw">else</span> <span class="kw">if</span> (score <span class="op">&gt;=</span> <span class="num">80</span>) {
    <span class="fn">println</span>(<span class="str">"B"</span>)
} <span class="kw">else</span> <span class="kw">if</span> (score <span class="op">&gt;=</span> <span class="num">70</span>) {
    <span class="fn">println</span>(<span class="str">"C"</span>)
} <span class="kw">else</span> {
    <span class="fn">println</span>(<span class="str">"F"</span>)
}</code></pre>

  <h2>While Loop</h2>

  <p>Repeats a block while a condition is true:</p>

  <pre><code>i <span class="op">=</span> <span class="num">0</span>
<span class="kw">while</span> (i <span class="op">&lt;</span> <span class="num">10</span>) {
    <span class="fn">println</span>(i)
    i <span class="op">=</span> i <span class="op">+</span> <span class="num">1</span>
}</code></pre>

  <h2>For Loop</h2>

  <p>C-style <code>for</code> loop with three parts: initialization, condition, and step:</p>

  <pre><code><span class="kw">for</span> (i <span class="op">=</span> <span class="num">0</span>; i <span class="op">&lt;</span> <span class="num">10</span>; i <span class="op">+=</span> <span class="num">1</span>) {
    <span class="fn">println</span>(i)
}</code></pre>

  <p>You can also use <code>var</code> in the initializer for dynamic variables:</p>

  <pre><code><span class="kw">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="num">0</span>; i <span class="op">&lt;</span> <span class="num">5</span>; i <span class="op">+=</span> <span class="num">1</span>) {
    <span class="fn">println</span>(i)
}</code></pre>

  <h2>Range Loops</h2>

  <p>The <code>..</code> operator creates a half-open integer range. Combined with <code>for-in</code>, it provides a concise counting loop:</p>

  <pre><code><span class="cmt">// Iterate from 0 to 4 (exclusive upper bound)</span>
<span class="kw">for</span> (i <span class="kw">in</span> <span class="num">0</span><span class="op">..</span><span class="num">5</span>) {
    <span class="fn">println</span>(i)       <span class="cmt">// prints 0, 1, 2, 3, 4</span>
}

<span class="cmt">// The bounds can be any integer expression</span>
n <span class="op">=</span> <span class="num">10</span>
<span class="kw">for</span> (i <span class="kw">in</span> <span class="num">0</span><span class="op">..</span>n) {
    <span class="fn">println</span>(i)
}

<span class="cmt">// Useful for index-based iteration</span>
items <span class="op">=</span> [<span class="num">100</span>, <span class="num">200</span>, <span class="num">300</span>]
<span class="kw">for</span> (i <span class="kw">in</span> <span class="num">0</span><span class="op">..</span><span class="fn">items.length</span>()) {
    <span class="fn">println</span>(<span class="fn">items.get</span>(i))
}</code></pre>

  <div class="callout info">
    <div class="callout-title">Note</div>
    <p><code>start..end</code> produces integers from <code>start</code> up to but <strong>not including</strong> <code>end</code>. If <code>start >= end</code>, the loop body is never executed. Range loops compile to efficient integer counter loops with no list allocation.</p>
  </div>

  <h2>Break and Continue</h2>

  <p><code>break</code> exits the innermost loop. <code>continue</code> skips to the next iteration:</p>

  <pre><code>i <span class="op">=</span> <span class="num">0</span>
<span class="kw">while</span> (i <span class="op">&lt;</span> <span class="num">100</span>) {
    i <span class="op">=</span> i <span class="op">+</span> <span class="num">1</span>

    <span class="kw">if</span> (i <span class="op">%</span> <span class="num">2</span> <span class="op">==</span> <span class="num">0</span>) {
        <span class="kw">continue</span>  <span class="cmt">// skip even numbers</span>
    }

    <span class="kw">if</span> (i <span class="op">&gt;</span> <span class="num">20</span>) {
        <span class="kw">break</span>     <span class="cmt">// stop after 20</span>
    }

    <span class="fn">println</span>(i)
}</code></pre>

  <h2>Return</h2>

  <p><code>return</code> exits the current function, optionally with a value:</p>

  <pre><code><span class="kw">def</span> <span class="fn">abs</span>(n: <span class="typ">Int</span>) <span class="op">-></span> <span class="typ">Int</span> {
    <span class="kw">if</span> (n <span class="op">&lt;</span> <span class="num">0</span>) {
        <span class="kw">return</span> <span class="op">-</span>n
    }
    <span class="kw">return</span> n
}

<span class="kw">def</span> <span class="fn">greet</span>() <span class="op">-></span> <span class="typ">Unit</span> {
    <span class="fn">println</span>(<span class="str">"Hello!"</span>)
    <span class="kw">return</span>  <span class="cmt">// explicit return for Unit functions</span>
}</code></pre>

  <h2>Ternary Expression</h2>

  <p>Nex uses Python-style ternary expressions where the <strong>value comes first</strong>, followed by the condition:</p>

  <pre><code>result <span class="op">=</span> <span class="str">"yes"</span> <span class="kw">if</span> condition <span class="kw">else</span> <span class="str">"no"</span>

<span class="cmt">// Use in assignments</span>
max_val <span class="op">=</span> a <span class="kw">if</span> a <span class="op">&gt;</span> b <span class="kw">else</span> b

<span class="cmt">// Chained (right-associative)</span>
label <span class="op">=</span> <span class="str">"high"</span> <span class="kw">if</span> x <span class="op">&gt;</span> <span class="num">100</span> <span class="kw">else</span> <span class="str">"mid"</span> <span class="kw">if</span> x <span class="op">&gt;</span> <span class="num">50</span> <span class="kw">else</span> <span class="str">"low"</span></code></pre>

  <div class="callout info">
    <div class="callout-title">Note</div>
    <p>The syntax is <code>then_value if condition else else_value</code> &mdash; this is an <strong>expression</strong> that produces a value and can be used in assignments, function arguments, and return statements.</p>
  </div>

  <h2>Pattern Matching (match)</h2>

  <p>The <code>match</code> expression compares a value against a set of patterns:</p>

  <pre><code><span class="kw">match</span> status {
    <span class="num">1</span> <span class="op">-&gt;</span> <span class="fn">println</span>(<span class="str">"active"</span>)
    <span class="num">2</span> <span class="op">-&gt;</span> <span class="fn">println</span>(<span class="str">"inactive"</span>)
    _ <span class="op">-&gt;</span> <span class="fn">println</span>(<span class="str">"unknown"</span>)
}</code></pre>

  <h3>Pattern Types</h3>

  <p><strong>Literal patterns</strong> &mdash; match exact values:</p>

  <pre><code><span class="kw">match</span> x {
    <span class="num">0</span> <span class="op">-&gt;</span> <span class="fn">println</span>(<span class="str">"zero"</span>)
    <span class="num">1</span> <span class="op">-&gt;</span> <span class="fn">println</span>(<span class="str">"one"</span>)
    _ <span class="op">-&gt;</span> <span class="fn">println</span>(<span class="str">"other"</span>)
}</code></pre>

  <p><strong>String patterns:</strong></p>

  <pre><code><span class="kw">match</span> name {
    <span class="str">"Alice"</span> <span class="op">-&gt;</span> <span class="fn">println</span>(<span class="str">"hi Alice"</span>)
    <span class="str">"Bob"</span> <span class="op">-&gt;</span> <span class="fn">println</span>(<span class="str">"hi Bob"</span>)
    _ <span class="op">-&gt;</span> <span class="fn">println</span>(<span class="str">"who?"</span>)
}</code></pre>

  <p><strong>Enum variant patterns:</strong></p>

  <pre><code><span class="kw">match</span> color {
    <span class="typ">Color</span>.Red <span class="op">-&gt;</span> <span class="fn">println</span>(<span class="str">"red"</span>)
    <span class="typ">Color</span>.Green <span class="op">-&gt;</span> <span class="fn">println</span>(<span class="str">"green"</span>)
    <span class="typ">Color</span>.Blue <span class="op">-&gt;</span> <span class="fn">println</span>(<span class="str">"blue"</span>)
}</code></pre>

  <p><strong>Guard clauses</strong> &mdash; add conditions with <code>if</code>:</p>

  <pre><code><span class="kw">match</span> score {
    s <span class="kw">if</span> s <span class="op">&gt;=</span> <span class="num">90</span> <span class="op">-&gt;</span> <span class="fn">println</span>(<span class="str">"A"</span>)
    s <span class="kw">if</span> s <span class="op">&gt;=</span> <span class="num">80</span> <span class="op">-&gt;</span> <span class="fn">println</span>(<span class="str">"B"</span>)
    s <span class="kw">if</span> s <span class="op">&gt;=</span> <span class="num">70</span> <span class="op">-&gt;</span> <span class="fn">println</span>(<span class="str">"C"</span>)
    _ <span class="op">-&gt;</span> <span class="fn">println</span>(<span class="str">"F"</span>)
}</code></pre>

  <div class="callout tip">
    <div class="callout-title">Tip</div>
    <p>Always include a wildcard <code>_</code> arm as the last pattern to handle all remaining cases.</p>
  </div>

  <h2>Type-Discriminating Match (is / as)</h2>

  <p>The <code>is</code> keyword in a match arm checks the <strong>runtime type</strong> of the scrutinee. The <code>as</code> keyword binds the value with the narrowed type inside the arm body:</p>

  <pre><code><span class="kw">public class</span> <span class="typ">AgentResult</span> {
    elapsed: <span class="typ">Float</span>
}

<span class="kw">public class</span> <span class="typ">SuccessResult</span> : <span class="typ">AgentResult</span> {
    summary: <span class="typ">String</span>
    <span class="kw">def</span> <span class="fn">summary</span>() <span class="op">-&gt;</span> <span class="typ">String</span> { <span class="kw">return</span> summary }
}

<span class="kw">public class</span> <span class="typ">ErrorResult</span> : <span class="typ">AgentResult</span> {
    message: <span class="typ">String</span>
    <span class="kw">def</span> <span class="fn">message</span>() <span class="op">-&gt;</span> <span class="typ">String</span> { <span class="kw">return</span> message }
}

result <span class="op">=</span> <span class="fn">getResult</span>()

<span class="kw">match</span> result {
    <span class="kw">is</span> <span class="typ">SuccessResult</span> <span class="kw">as</span> success <span class="op">-&gt;</span> {
        <span class="fn">println</span>(<span class="str">$"Done: {success.summary()}"</span>)
    }
    <span class="kw">is</span> <span class="typ">ErrorResult</span> <span class="kw">as</span> err <span class="op">-&gt;</span> {
        <span class="fn">println</span>(<span class="str">$"Failed: {err.message()}"</span>)
    }
    _ <span class="op">-&gt;</span> {
        <span class="fn">println</span>(<span class="str">"Unknown result type"</span>)
    }
}</code></pre>

  <p><strong>Works with interfaces:</strong></p>

  <pre><code><span class="kw">match</span> obj {
    <span class="kw">is</span> <span class="typ">Skill</span> <span class="kw">as</span> skill <span class="op">-&gt;</span> skill.<span class="fn">execute</span>(ctx)
    <span class="kw">is</span> <span class="typ">Disposable</span> <span class="kw">as</span> d <span class="op">-&gt;</span> d.<span class="fn">dispose</span>()
    _ <span class="op">-&gt;</span> {}
}</code></pre>

  <p><strong>Guards apply after the type check:</strong></p>

  <pre><code><span class="kw">match</span> task {
    <span class="kw">is</span> <span class="typ">SuccessResult</span> <span class="kw">as</span> s <span class="kw">if</span> s.elapsed <span class="op">&gt;</span> <span class="num">5000</span> <span class="op">-&gt;</span> <span class="fn">println</span>(<span class="str">"Slow!"</span>)
    <span class="kw">is</span> <span class="typ">SuccessResult</span> <span class="kw">as</span> s <span class="op">-&gt;</span> <span class="fn">println</span>(<span class="str">"OK"</span>)
    <span class="kw">is</span> <span class="typ">ErrorResult</span> <span class="kw">as</span> err <span class="op">-&gt;</span> <span class="fn">println</span>(err.<span class="fn">message</span>())
}</code></pre>

  <p><strong>Used as an expression:</strong></p>

  <pre><code>message <span class="op">=</span> <span class="kw">match</span> result {
    <span class="kw">is</span> <span class="typ">SuccessResult</span> <span class="kw">as</span> s <span class="op">-&gt;</span> s.<span class="fn">summary</span>()
    <span class="kw">is</span> <span class="typ">ErrorResult</span> <span class="kw">as</span> e <span class="op">-&gt;</span> e.<span class="fn">message</span>()
    _ <span class="op">-&gt;</span> <span class="str">"Unknown"</span>
}</code></pre>

  <div class="callout info">
    <div class="callout-title">Rules</div>
    <ul>
      <li>Arms are checked top to bottom &mdash; first match wins</li>
      <li>Put more specific types before less specific (e.g., <code>is Dog</code> before <code>is Animal</code>)</li>
      <li>Always include a <code>_</code> wildcard arm &mdash; the compiler warns if omitted</li>
      <li>The binding (<code>as name</code>) has the narrowed type inside the arm body</li>
      <li>The cast is zero-cost &mdash; same pointer, different compile-time type</li>
    </ul>
  </div>

  <h2>Comments</h2>

  <pre><code><span class="cmt">// This is a single-line comment</span>

<span class="cmt">/* This is a
   multi-line comment */</span></code></pre>

  <div class="callout info">
    <div class="callout-title">Note</div>
    <p>Block comments <code>/* ... */</code> do not nest in v1.</p>
  </div>

  <div class="page-nav">
    <a href="operators.html">
      <span class="nav-label">Previous</span>
      <span class="nav-title">&larr; Operators &amp; Expressions</span>
    </a>
    <a href="functions.html">
      <span class="nav-label">Next</span>
      <span class="nav-title">Functions &rarr;</span>
    </a>
  </div>

</main>
<script src="nav.js"></script>
<script src="script.js"></script>
</body>
</html>
