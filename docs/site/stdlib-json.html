<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>std.json - Nex Docs</title>
  <link rel="stylesheet" href="styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
<header class="site-header">
  <button class="menu-toggle">&#9776;</button>
  <div class="logo">Nex <span>Documentation</span></div>
  <div class="header-right"><span class="version-badge">v0.1.0</span></div>
</header>
<nav class="sidebar"></nav>
<main class="main-content">

  <div class="breadcrumbs"><a href="index.html">Docs</a><span class="sep">/</span><a href="stdlib-overview.html">Standard Library</a><span class="sep">/</span>std.json</div>

  <h1>std.json</h1>
  <p class="page-subtitle">JSON parsing and serialization.</p>

  <pre><code><span class="kw">import</span> std.json</code></pre>

  <h2>Parsing &amp; Serialization</h2>

  <h4>json_parse</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">json_parse</span>(s: <span class="typ">String</span>) <span class="op">-&gt;</span> <span class="typ">Var</span>
  </div>
  <p>Parses a JSON string and returns a handle to the parsed JSON object. The handle is a <code>Var</code> that can be queried with the accessor functions below. Returns a null handle if parsing fails.</p>

  <pre><code><span class="kw">import</span> std.json

<span class="kw">var</span> data <span class="op">=</span> <span class="fn">json_parse</span>(<span class="str">"{\"name\": \"Alice\", \"age\": 30}"</span>)
name <span class="op">=</span> <span class="fn">json_get_string</span>(data, <span class="str">"name"</span>)
<span class="fn">println</span>(name)   <span class="cmt">// Alice</span></code></pre>

  <h4>json_stringify</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">json_stringify</span>(handle: <span class="typ">Var</span>) <span class="op">-&gt;</span> <span class="typ">String</span>
  </div>
  <p>Converts a JSON handle back into a JSON string representation.</p>

  <pre><code><span class="kw">import</span> std.json

<span class="kw">var</span> data <span class="op">=</span> <span class="fn">json_parse</span>(<span class="str">"{\"x\": 1, \"y\": 2}"</span>)
text <span class="op">=</span> <span class="fn">json_stringify</span>(data)
<span class="fn">println</span>(text)   <span class="cmt">// {"x":1,"y":2}</span></code></pre>

  <h2>Accessors</h2>

  <h4>json_get_string</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">json_get_string</span>(handle: <span class="typ">Var</span>, key: <span class="typ">String</span>) <span class="op">-&gt;</span> <span class="typ">String</span>
  </div>
  <p>Returns the string value associated with <code>key</code> in the JSON object. Returns an empty string if the key does not exist or the value is not a string.</p>

  <h4>json_get_int</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">json_get_int</span>(handle: <span class="typ">Var</span>, key: <span class="typ">String</span>) <span class="op">-&gt;</span> <span class="typ">Int</span>
  </div>
  <p>Returns the integer value associated with <code>key</code>. Returns <code>0</code> if the key does not exist or the value is not a number.</p>

  <h4>json_get_float</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">json_get_float</span>(handle: <span class="typ">Var</span>, key: <span class="typ">String</span>) <span class="op">-&gt;</span> <span class="typ">Double</span>
  </div>
  <p>Returns the floating-point value associated with <code>key</code>. Returns <code>0.0</code> if the key does not exist or the value is not a number.</p>

  <h4>json_get_bool</h4>
  <div class="signature">
    <span class="kw">def</span> <span class="fn">json_get_bool</span>(handle: <span class="typ">Var</span>, key: <span class="typ">String</span>) <span class="op">-&gt;</span> <span class="typ">Bool</span>
  </div>
  <p>Returns the boolean value associated with <code>key</code>. Returns <code>false</code> if the key does not exist or the value is not a boolean.</p>

  <pre><code><span class="kw">import</span> std.json

json_str <span class="op">=</span> <span class="str">"{\"host\": \"localhost\", \"port\": 8080, \"ratio\": 0.75, \"debug\": true}"</span>
<span class="kw">var</span> config <span class="op">=</span> <span class="fn">json_parse</span>(json_str)

host <span class="op">=</span> <span class="fn">json_get_string</span>(config, <span class="str">"host"</span>)
port <span class="op">=</span> <span class="fn">json_get_int</span>(config, <span class="str">"port"</span>)
ratio <span class="op">=</span> <span class="fn">json_get_float</span>(config, <span class="str">"ratio"</span>)
debug <span class="op">=</span> <span class="fn">json_get_bool</span>(config, <span class="str">"debug"</span>)

<span class="fn">print</span>(<span class="str">"Host: "</span>)
<span class="fn">println</span>(host)       <span class="cmt">// localhost</span>
<span class="fn">print</span>(<span class="str">"Port: "</span>)
<span class="fn">println</span>(port)       <span class="cmt">// 8080</span>
<span class="fn">print</span>(<span class="str">"Ratio: "</span>)
<span class="fn">println</span>(ratio)      <span class="cmt">// 0.75</span>
<span class="fn">print</span>(<span class="str">"Debug: "</span>)
<span class="fn">println</span>(debug)      <span class="cmt">// true</span></code></pre>

  <h2>Complete Example</h2>

  <pre><code><span class="kw">import</span> std.json
<span class="kw">import</span> std.io

<span class="cmt">// Parse a JSON configuration file</span>
<span class="kw">def</span> <span class="fn">load_config</span>(path: <span class="typ">String</span>) <span class="op">-&gt;</span> <span class="typ">Unit</span> {
    <span class="kw">if</span> (<span class="op">!</span><span class="fn">file_exists</span>(path)) {
        <span class="fn">println</span>(<span class="str">"Config file not found"</span>)
        <span class="kw">return</span>
    }

    <span class="kw">using</span> (f <span class="op">=</span> File.<span class="fn">open</span>(path)) {
        content <span class="op">=</span> f.<span class="fn">read_all</span>()
    }

    <span class="kw">var</span> cfg <span class="op">=</span> <span class="fn">json_parse</span>(content)

    app_name <span class="op">=</span> <span class="fn">json_get_string</span>(cfg, <span class="str">"name"</span>)
    version <span class="op">=</span> <span class="fn">json_get_string</span>(cfg, <span class="str">"version"</span>)
    max_conn <span class="op">=</span> <span class="fn">json_get_int</span>(cfg, <span class="str">"max_connections"</span>)
    verbose <span class="op">=</span> <span class="fn">json_get_bool</span>(cfg, <span class="str">"verbose"</span>)

    <span class="fn">print</span>(<span class="str">"App: "</span>)
    <span class="fn">print</span>(app_name)
    <span class="fn">print</span>(<span class="str">" v"</span>)
    <span class="fn">println</span>(version)

    <span class="fn">print</span>(<span class="str">"Max connections: "</span>)
    <span class="fn">println</span>(max_conn)

    <span class="kw">if</span> (verbose) {
        <span class="fn">println</span>(<span class="str">"Verbose logging enabled"</span>)
    }

    <span class="cmt">// Round-trip: re-serialize</span>
    output <span class="op">=</span> <span class="fn">json_stringify</span>(cfg)
    <span class="fn">println</span>(<span class="str">"Serialized: "</span>)
    <span class="fn">println</span>(output)
}

<span class="fn">load_config</span>(<span class="str">"config.json"</span>)</code></pre>

  <div class="page-nav">
    <a href="stdlib-path.html">
      <span class="nav-label">Previous</span>
      <span class="nav-title">&larr; std.path</span>
    </a>
    <a href="stdlib-process.html">
      <span class="nav-label">Next</span>
      <span class="nav-title">std.process &rarr;</span>
    </a>
  </div>

</main>
<script src="nav.js"></script>
<script src="script.js"></script>
</body>
</html>
